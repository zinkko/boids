(this.webpackJsonpboids=this.webpackJsonpboids||[]).push([[0],{25:function(i,t,n){},28:function(i,t,n){},29:function(i,t,n){"use strict";n.r(t);var e=n(0),o=n(1),s=n.n(o),r=n(16),a=n.n(r),c=(n(25),n(7)),h=n(2),u=n(5),d=n(6),l=function(){function i(t,n){Object(u.a)(this,i),this.x=void 0,this.y=void 0,this.x=t/Math.hypot(t,n),this.y=n/Math.hypot(t,n)}return Object(d.a)(i,[{key:"turn",value:function(t){return new i(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t))}},{key:"opposite",value:function(){return new i(-this.x,-this.y)}},{key:"angle",value:function(){return this.y<0?-Math.acos(this.x):Math.acos(this.x)}}]),i}(),f=function(i,t,n){return{x:i.x+t*n.x,y:i.y+t*n.y}},v=function(i,t){return(i%t+t)%t},b=function(i,t){var n=i.x-t.x,e=i.y-t.y;return n*n+e*e},p=function(i){return{x:i.map((function(i){return i.x})).reduce(j)/i.length,y:i.map((function(i){return i.y})).reduce(j)/i.length}},x=function(i){var t=p(i),n=t.x,e=t.y;return 0===n&&0===e?new l(1,0):new l(n,e)},j=function(i,t){return i+t},y=n(14),O=function(){function i(t,n){Object(u.a)(this,i),this.size=void 0,this.speed=void 0,this.turnSpeed=void 0,this.direction=void 0,this.pos=void 0,this.world=void 0,this.visionRadius=void 0,this.color=void 0,this.crowdingDistance=void 0,this.size=(null===n||void 0===n?void 0:n.size)||5,this.speed=(null===n||void 0===n?void 0:n.speed)||.1,this.turnSpeed=(null===n||void 0===n?void 0:n.turnSpeed)||.05,this.direction=(null===n||void 0===n?void 0:n.direction)||new l(1,0),this.pos=(null===n||void 0===n?void 0:n.pos)||{x:100,y:100},this.world=t,this.visionRadius=(null===n||void 0===n?void 0:n.visionRadius)||20*this.size,this.crowdingDistance=(null===n||void 0===n?void 0:n.crowdingDistance)||5*this.size,this.color=(null===n||void 0===n?void 0:n.color)||"black"}return Object(d.a)(i,[{key:"ai",value:function(){var i=this.world.boidsWithinVision(this),t=[],n=function(n,e){var o=n(i);if(o)for(var s=0;s<e;s++)t.push(o)};i.length>0&&(n(this.separate.bind(this),2),n(this.align.bind(this),1),n(this.cohere.bind(this),1)),t.length>0&&this.steerToward(x(t))}},{key:"avoidWall",value:function(){var i,t,n=this.world.nearestWall(this),e=Object(c.a)(n,2),o=e[0];return e[1]<=this.visionRadius&&(i=m[o],t=this.direction,Math.acos(i.x*t.x+i.y*t.y)<Math.PI/2)?m[o].opposite():this.direction}},{key:"separate",value:function(i){var t=this,n=i.filter((function(i){return b(i.pos,t.pos)<t.crowdingDistance*t.crowdingDistance}));if(0===n.length)return null;var e=n[0],o=10*this.world.width;return n.forEach((function(i){var n=b(t.pos,i.pos);n<o&&(o=n,e=i)})),new l(this.pos.x-e.pos.x,this.pos.y-e.pos.y)}},{key:"align",value:function(i){var t=[this].concat(Object(y.a)(i));return x(t.map((function(i){return i.direction})))}},{key:"cohere",value:function(i){var t=[this].concat(Object(y.a)(i)),n=p(t.map((function(i){return i.pos})));return new l(n.x-this.pos.x,n.y-this.pos.y)}},{key:"steerToward",value:function(i){var t=this.direction.angle(),n=i.angle(),e=v(t-n,2*Math.PI),o=-Math.sign(Math.PI-e);this.direction=this.direction.turn(o*this.turnSpeed)}},{key:"draw",value:function(i){var t=.8*Math.PI,n=f(this.pos,this.size,this.direction),e=f(this.pos,this.size,this.direction.turn(t)),o=f(this.pos,this.size,this.direction.turn(-t)),s=f(this.pos,.5*this.size,this.direction.opposite());i.beginPath(),i.fillStyle=this.color,i.moveTo(n.x,n.y),i.lineTo(e.x,e.y),i.lineTo(s.x,s.y),i.lineTo(o.x,o.y),i.lineTo(n.x,n.y),i.fill()}}]),i}(),g=function(){function i(t,n){var e=this;Object(u.a)(this,i),this.width=void 0,this.height=void 0,this.boids=void 0,this.simulateWorld=function(i){e.boids.forEach((function(t){t.ai(),t.pos.x+=i*t.speed*t.direction.x,t.pos.y+=i*t.speed*t.direction.y,e.simulatePortalWalls(t)}))},this.hilightGroup=function(i,t){i.beginPath(),i.fillStyle="aliceblue",i.moveTo(t.pos.x+t.visionRadius/2,t.pos.y),i.arc(t.pos.x,t.pos.y,t.visionRadius/2,0,2*Math.PI),i.fill()},this.hilightVision=function(i){if(!(e.boids.length<1)){var t=e.boids[0],n=e.boidsWithinVision(t);i.beginPath(),i.strokeStyle="gold",i.arc(t.pos.x,t.pos.y,t.visionRadius,0,2*Math.PI),i.moveTo(t.pos.x+5,t.pos.y),i.arc(t.pos.x,t.pos.y,5,0,2*Math.PI),i.stroke(),i.beginPath(),i.strokeStyle="green",n.forEach((function(t){i.moveTo(t.pos.x+5,t.pos.y),i.arc(t.pos.x,t.pos.y,5,0,2*Math.PI)})),i.stroke()}},this.hilightNearestWall=function(i){if(!(e.boids.length<1)){var t=e.nearestWall(e.boids[0])[0],n="north"===t||"west"===t?{x:0,y:0}:{x:e.width,y:e.height},o="west"===t||"east"===t?{x:n.x,y:e.height-n.y}:{x:e.width-n.x,y:n.y};i.beginPath(),i.strokeStyle="red",i.moveTo(n.x,n.y),i.lineTo(o.x,o.y),i.stroke(),i.strokeStyle="black"}},this.draw=function(i,t){i.clearRect(0,0,e.width,e.height),i.fillStyle="white",i.fillRect(0,0,e.width,e.height),i.fillStyle="black",t.showGroup&&e.boids.forEach((function(t){e.hilightGroup(i,t)})),e.boids.forEach((function(t){t.draw(i)})),t.showVision&&e.hilightVision(i),t.showCenterOfMass&&e.hilightBoidCenterOfMass(i)},this.nearestWall=function(i){var t=i.pos,n=t.x,o=t.y,s=o,r="north";return n<s&&(s=n,r="west"),e.width-n<s&&(s=e.width-n,r="east"),e.height-o<s&&(s=e.height-o,r="south"),[r,s]},this.width=t||500,this.height=n||400,this.boids=[]}return Object(d.a)(i,[{key:"addBoid",value:function(i){this.boids.push(new O(this,i))}},{key:"removeBoid",value:function(){this.boids=this.boids.slice(0,this.boids.length-1)}},{key:"amountOfBoids",value:function(){return this.boids.length}},{key:"boidsWithinVision",value:function(i){return this.boids.filter((function(t){return t!==i&&b(i.pos,t.pos)<=i.visionRadius*i.visionRadius}))}},{key:"simulatePortalWalls",value:function(i){i.pos.x=v(i.pos.x,this.width),i.pos.y=v(i.pos.y,this.height)}},{key:"simulateSolidWalls",value:function(i){i.pos.x=Math.min(Math.max(i.pos.x,0),this.width),i.pos.y=Math.min(Math.max(i.pos.y,0),this.height)}},{key:"hilightBoidCenterOfMass",value:function(i){var t=p(this.boids.map((function(i){return i.pos})));i.beginPath(),i.arc(t.x,t.y,5,0,2*Math.PI),i.stroke()}},{key:"hilightAngles",value:function(i){i.beginPath();this.boids.forEach((function(t){var n=t.pos,e=n.x,o=n.y,s=t.direction;i.moveTo(e+20,o),i.arc(e,o,20,0,s.angle())})),i.stroke()}},{key:"changeBoidSize",value:function(i){i<1||.5*this.height<i||this.boids.forEach((function(t){t.size=i}))}}]),i}(),m={north:new l(0,-1),south:new l(0,1),east:new l(1,0),west:new l(-1,0)},w=function(i,t){return Math.random()*Math.abs(i-t)+Math.min(i,t)},k=function(i,t,n){var e=90,o=50;return"saturation"!==t&&"both"!==t||(e=w((null===n||void 0===n?void 0:n.minSaturation)||0,(null===n||void 0===n?void 0:n.maxSaturation)||100)),"lightness"!==t&&"both"!==t||(o=w((null===n||void 0===n?void 0:n.minLightness)||0,(null===n||void 0===n?void 0:n.maxLightness)||100)),"hsl(".concat(i,", ").concat(e,"%, ").concat(o,"%)")},M=function(){return i=Math.random()*Math.PI*2,new l(Math.cos(i),Math.sin(i));var i},P=function(i){return{x:w(i.maxX,i.minX),y:w(i.maxY,i.minY)}};function B(i){var t,n=i.config,s=Object(o.useRef)(null),r=Object(o.useState)(function(i){for(var t=new g(800,400),n=i.amountOfBoids,e=0;e<n;e++)t.addBoid(Object(h.a)(Object(h.a)({},i.boidProperties||{}),{},{pos:P({maxX:t.width-20,minX:20,maxY:t.height-20,minY:20}),color:k(240,"lightness",{minLightness:20,maxLightness:70}),direction:M()}));return t}(n)),a=Object(c.a)(r,2),u=a[0];a[1];for(u.changeBoidSize((null===(t=n.boidProperties)||void 0===t?void 0:t.size)||5);u.amountOfBoids()>n.amountOfBoids&&n.amountOfBoids>=0;)u.removeBoid();for(;u.amountOfBoids()<n.amountOfBoids;)u.addBoid(n.boidProperties||{});return Object(o.useEffect)((function(){var i,t=null,e=null===s||void 0===s||null===(i=s.current)||void 0===i?void 0:i.getContext("2d");return e&&function(i){var e=performance.now();!function o(s){var r=s-e;e=s,u.simulateWorld(r),u.draw(i,n),t=requestAnimationFrame(o)}(e)}(e),function(){t&&cancelAnimationFrame(t)}}),[s,u,n]),Object(e.jsx)("div",{className:"Simulation",children:Object(e.jsx)("canvas",{ref:s,id:"world",width:u.width,height:u.height})})}var S=n(3),z=n(9),C=n(4);function T(){var i=Object(S.a)(["\n    color: #343434;\n    padding-bottom: 4px;\n    margin-bottom: 32px;\n    border-bottom: solid 1px blue;\n"]);return T=function(){return i},i}function V(){var i=Object(S.a)(["\n    display: flex;\n    flex-direction: column;\n    justify-content: left;\n\n    padding: 16px;\n\n"]);return V=function(){return i},i}function W(i){var t=i.label,n=i.children;return Object(e.jsxs)(I,{children:[Object(e.jsx)(R,{children:t}),n]})}var I=C.a.div(V()),R=C.a.label(T());function E(){var i=Object(S.a)(["\n    display: flex;\n    width: 100%;\n    justify-content: space-around;\n"]);return E=function(){return i},i}function D(i){var t=i.unit,n=i.value,o=i.setValue;return Object(e.jsxs)(N,{children:[Object(e.jsx)("button",{onClick:function(){return o(n-1)},children:"-"}),n,t&&" ".concat(t),Object(e.jsx)("button",{onClick:function(){return o(n+1)},children:"+"})]})}var N=C.a.div(E());function F(i){var t=i.values,n=i.setValues,o=t.showCenterOfMass,s=t.showVision,r=t.showGroup;return Object(e.jsxs)("div",{className:"DrawingOptions",children:[Object(e.jsxs)("div",{children:[Object(e.jsx)("input",{type:"checkbox",checked:o,onClick:function(){return n(Object(h.a)(Object(h.a)({},t),{},{showCenterOfMass:!o}))}}),"\xa0show center of mass"]}),Object(e.jsxs)("div",{children:[Object(e.jsx)("input",{type:"checkbox",checked:s,onClick:function(){return n(Object(h.a)(Object(h.a)({},t),{},{showVision:!s}))}}),"\xa0show vision of boids"]}),Object(e.jsxs)("div",{children:[Object(e.jsx)("input",{type:"checkbox",checked:r,onClick:function(){return n(Object(h.a)(Object(h.a)({},t),{},{showGroup:!r}))}}),"\xa0show groups"]})]})}function L(){var i=Object(S.a)(["\n    color: #343434;\n"]);return L=function(){return i},i}function A(i){var t,n=i.values,o=i.setValues,s=function(i,t){if(i in n)o(Object(h.a)(Object(h.a)({},n),{},Object(z.a)({},i,t)));else{var e=Object(h.a)(Object(h.a)({},n.boidProperties),{},Object(z.a)({},i,t));o(Object(h.a)(Object(h.a)({},n),{},{boidProperties:e}))}};return Object(e.jsxs)("div",{className:"Controls",children:[Object(e.jsx)(G,{children:"Settings"}),Object(e.jsx)(W,{label:"Amount of Boids",children:Object(e.jsx)(D,{value:n.amountOfBoids,setValue:function(i){return s("amountOfBoids",i)}})}),Object(e.jsx)(W,{label:"Boid Size",children:Object(e.jsx)(D,{unit:"px",value:(null===(t=n.boidProperties)||void 0===t?void 0:t.size)||5,setValue:function(i){return s("size",i)}})}),Object(e.jsx)(W,{label:"Drawing Options",children:Object(e.jsx)(F,{values:n,setValues:o})})]})}var G=C.a.h2(L());n(28);function X(){return Object(e.jsx)("div",{className:"Header",children:Object(e.jsx)("h1",{children:"Boid Simulation"})})}function Y(i){var t=i.children;return Object(e.jsx)("div",{className:"Panel",children:t})}var J={amountOfBoids:80,boidProperties:{size:5}};var q=function(){var i=Object(o.useState)(J),t=Object(c.a)(i,2),n=t[0],s=t[1];return Object(e.jsxs)("div",{className:"App",children:[Object(e.jsx)(X,{}),Object(e.jsxs)(Y,{children:[Object(e.jsx)(B,{config:n}),Object(e.jsx)(A,{values:n,setValues:s})]})]})},H=function(i){i&&i instanceof Function&&n.e(3).then(n.bind(null,30)).then((function(t){var n=t.getCLS,e=t.getFID,o=t.getFCP,s=t.getLCP,r=t.getTTFB;n(i),e(i),o(i),s(i),r(i)}))};document.title="Boids",a.a.render(Object(e.jsx)(s.a.StrictMode,{children:Object(e.jsx)(q,{})}),document.getElementById("root")),H()}},[[29,1,2]]]);
//# sourceMappingURL=main.d600c88e.chunk.js.map